{% extends 'paper/layout.html' %}{% load crispy_forms_tags %}{% block content%}{% include 'paper/htmx.html' %}
<div class='row'>

    <div class='col-7'>
        <div class='card'>
            <div class='card-body'>

                <div>
                    {% if filter.qs %}
                    <a class="btn btn-primary btn-sm" href="{% url 'get_excel_report_order' slug=order_type %}" style="float:right;">Download Excel</a>
                    {% endif %}
                    <h5 class=""> {{ order_type }} List </h5>

                </div>
                <div>
                    {% include 'paper/catalogue/product_filter.html'%}
                </div>
                <p class="text-muted"> Here you can find all the quotations raised by your dealers or even some
                    administrator created behalf of them. </p>
                <div class="table-responsive">
                    <table class="table  table-hover table-sm">
                        <thead class="thead-dark">
                        <tr class="table-header">
                            <th scope="col">ID</th>
                            <th scope="col">Name</th>
                            <th scope="col">Ordered on</th>
                            <th scope="col">Ordered by</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for object in filter %}
                        <tr>
                            <!--                    <td scope="row"> </td>-->
                            <td>
                                <div class="">{{ forloop.counter }}</div>
                            </td>
                            <td>
                                <div class=""><a href="{% url 'get_orderline' order_id=object.id %}">{{ object.id_as_text }}</a></div>
                            </td>
                            <td>
                                <div class="">{{ object.created_at }}</div>
                            </td>
                            <td>
                                <div class="">{{ object.dealer }}</div>
                            </td>

                        </tr>
                        {% empty %}
                        <tr>
                            <td class="text-center text-muted" colspan="100%"> No Active Quotations left in the book.
                                Check back later
                            </td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% include 'paper/pagination.html' %}
        </div>
    </div>
    <div class='col-5'>
        <div class='card'>
            <div class='card-body'>
                <h3>Create {{ order_type }}</h3>
                <div class="card-header">
                    {% if form.errors %}
                    <pre>
                        {{ form.errors }}
                    </pre>
                    {% endif %}
                </div>
                <form method="POST">
                    {% csrf_token %}
                    {{ orderform | crispy }}
                    <hr>
                    <code>You can use the ADD PRODUCT button below to add a new item into the order.</code>
                    <div id="lineform"></div>
                    <button class="btn btn-sm btn-success" hx-get="{% url 'get_orderline_form' %}" hx-swap="beforeend"
                            hx-target="#lineform" type="button"> Add product
                    </button>
                    <input hx-post="{% url 'salesorder-list' %}" type="hidden">
                    <button class='btn btn btn-danger' style="float:right;" type='submit'> Place Order</button>
                </form>
            </div>
        </div>
    </div>

</div>{% include 'paper/swal.html' %}

<script type="tex/script">
function showForm(e){
  $('.'+e).toggle();
}
    var cloneForm = function(form, start) {
        start = start || 0;

        return function() {
            var clone = form.clone();

            clone.find(':input').attr('id', function(i, val) {
                return val + start;
            });
            start++;

            return clone;
        };
    };
    var cloneContactForm = cloneForm($('.line-form'), 5);

    // Now I want to clone it and put it somewhere.
    $(cloneContactForm()).appendTo('.order-form');


</script>{% endblock %}



